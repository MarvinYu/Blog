<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://gmpg.org/xfn/11">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Data structures as queries: Expressing CRDTs using Datalog &mdash; Martin Kleppmann&rsquo;s talks</title>
    <link rel="stylesheet" type="text/css" media="screen, print, handheld" href="/css/typography.css" />
<link rel="stylesheet" type="text/css" media="screen" href="/css/style.css" />
<link rel="stylesheet" type="text/css" media="all" href="/css/pygments-default.css" />
<link rel="stylesheet" type="text/css" media="all" href="/css/ansi2html.css" />
<link rel="stylesheet" type="text/css" media="all" href="/css/customizations.css?5" />
<!--[if lt IE 8]>
    <link rel="stylesheet" href="/css/ie.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/martinkl?format=xml" title="Martin Kleppmann's blog" />
<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>

</head>

<body class="wordpress">
    <div id="page">
        <p id="top">
    <a id="to-content" href="#content" title="Skip to content">Skip to content</a>
</p>

<div id="header">
    <div class="wrapper">
        <strong id="blog-title">
            <a href="/" title="Home" rel="home">Martin Kleppmann</a>
        </strong>
    </div>
</div>

<div id="sub-header">
    <div class="wrapper">
        <div id="navigation">
            <ul>
                <li class="page_item"><a href="/contact.html" title="About/Contact">About/Contact</a></li>
            </ul>
        </div>
    </div>
</div>

<hr class="divider">


        <div class="wrapper">
            <div id="content">
                <a class="twitter-share-button" href="https://twitter.com/share" data-text="Data structures as queries: Expressing CRDTs using Datalog"
                    data-via="martinkl" data-related="martinkl" data-size="large" data-count="none">Tweet</a>

                <h1>Data structures as queries: Expressing CRDTs using Datalog</h1>

                <p>
                  A talk at
                  
                    <a href="http://www.dagstuhl.de/18091">Dagstuhl Seminar 18091</a>,
                  
                  Schloss Dagstuhl, Germany, 26 Feb 2018
                </p>

                <ul>
                  
                  
                    <li><a href="https://speakerdeck.com/ept/data-structures-as-queries-expressing-crdts-using-datalog">Slides</a></li>
                  
                  
                  
                </ul>

                <p>I participated in <a href="http://www.dagstuhl.de/18091">Dagstuhl Seminar 18091:
<em>Data Consistency in Distributed Systems: Algorithms, Programs, and Databases.</em></a></p>

<script async="" class="speakerdeck-embed" data-id="f45f22e4fb1d4726b408a516cb11f2a8" data-ratio="1.33333333333333" src="//speakerdeck.com/assets/embed.js"></script>

<h2 id="abstract">Abstract</h2>

<p>Currently there are two conventional formulations of CRDTs: state-based (where we prove that our
merge function is commutative, associative, and idempotent) or operation-based (where we prove that
the functions that apply operations to the local state are commutative). I propose a third
formulation in which the CRDT is expressed as a query over a monotonically growing set of
operations. The merge function for the set of operations is just the set union, which is trivially
commutative, associative, and idempotent. By expressing the desired data structure as
a deterministic query over that set we get convergence automatically. I will discuss how we can use
the Datalog language to express such queries, how this query-based approach can help us better
understand existing CRDTs, and how it facilitates designing new ones.</p>

<h2 id="references">References</h2>

<ol>
  <li>Marc Shapiro, Nuno Preguiça, Carlos Baquero, and Marek Zawirski:
“<a href="https://pages.lip6.fr/Marek.Zawirski/papers/RR-7687.pdf">Conflict-Free Replicated Data Types</a>,”
at <em>13th International Symposium on Stabilization, Safety, and Security of Distributed Systems</em>
(SSS), pages 386–400, October 2011. <a href="http://dx.doi.org/10.1007/978-3-642-24550-3_29">doi:10.1007/978-3-642-24550-3_29</a></li>
  <li>Hyun-Gul Roh, Myeongjae Jeon, Jin-Soo Kim, and Joonwon Lee:
“<a href="http://csl.skku.edu/papers/jpdc11.pdf">Replicated abstract data types: Building blocks for collaborative applications</a>,”
<em>Journal of Parallel and Distributed Computing</em>, volume 71, number 3, pages 354–368, March 2011.
<a href="http://dx.doi.org/10.1016/j.jpdc.2010.12.006">doi:10.1016/j.jpdc.2010.12.006</a></li>
  <li>Victor Grishchenko:
“<a href="http://www.ds.ewi.tudelft.nl/~victor/polo.pdf">Citrea and Swarm: Partially ordered op logs in the browser</a>,”
at <em>1st Workshop on Principles and Practice of Eventual Consistency</em> (PaPEC 2014), April 2014.
<a href="http://dx.doi.org/10.1145/2596631.2596641">doi:10.1145/2596631.2596641</a></li>
  <li>Hagit Attiya, Sebastian Burckhardt, Alexey Gotsman, et al.:
“<a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/07/podc16-complete.pdf">Specification and Complexity of Collaborative Text Editing</a>,”
at <em>ACM Symposium on Principles of Distributed Computing</em> (PODC), pages 259–268, July 2016.
<a href="http://dx.doi.org/10.1145/2933057.2933090">doi:10.1145/2933057.2933090</a></li>
  <li>Todd J Green, Shan Shan Huang, Boon Thau Loo, and Wenchao Zhou:
“<a href="http://blogs.evergreen.edu/sosw/files/2014/04/Green-Vol5-DBS-017.pdf">Datalog and Recursive Query Processing</a>,”
<em>Foundations and Trends in Databases</em>, volume 5, number 2, pages 105–195, November 2013.
<a href="http://dx.doi.org/10.1561/1900000017">doi:10.1561/1900000017</a></li>
</ol>

            </div>

            <div id="sidebar">
                <div id="carrington-subscribe" class="widget">
    <h2 class="widget-title">Subscribe</h2>
    <a class="feed" title="RSS 2.0 feed for posts" rel="alternate" href="http://feeds.feedburner.com/martinkl">
        Site <acronym title="Really Simple Syndication">RSS</acronym> feed
    </a>

    <div class="mailing-list-signup">
        <p>
            To get notified when I write something new,
            <a href="https://twitter.com/martinkl">follow me</a> on Twitter,
            <a href="http://feeds.feedburner.com/martinkl">subscribe</a> to the RSS feed,
            or enter your email address:
        </p>

        <form action="https://mail.martinkl.com/mailing-list" method="post">
            <fieldset>
                <div class="mc-field-group">
                    <label for="mce-EMAIL">Email address:</label>
                    <input type="email" value="" name="email" class="required email" id="mce-EMAIL">
                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
                </div>
                <input type="hidden" name="list" value="blog">
            </fieldset>
        </form>

        <p class="disclaimer">
            I won't give your address to anyone else, won't send you any spam, and you can unsubscribe at any time.
        </p>
    </div>
</div>

<div id="primary-sidebar">
    <div id="book-promo" class="widget">
        <h2 class="title">My book</h2>
        <p><a href="http://dataintensive.net" target="_top"><img src="/images/book-cover-small.png" border="0" alt="Designing Data-Intensive Applications" width="180" height="236"/></a></p>
        <p>My book,
        <a href="http://dataintensive.net"><em>Designing Data-Intensive Applications</em></a>,
        was published by O’Reilly in March 2017.</p>
    </div>

    <div class="widget">
        <p>I am a researcher at the
        <a href="http://www.cl.cam.ac.uk/">University of Cambridge</a>,
        working on the <a href="http://www.trvedata.org/">TRVE DATA</a> project
        at the intersection of databases, distributed systems, and information security.</p>
    </div>

    <div id="tweets" class="widget">
        <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/martinkl" data-widget-id="557543934298423296">Tweets by @martinkl</a>
    </div>
</div>

                





<div id="secondary-sidebar">
    <div class="widget">
        <h2 class="title">Recent posts</h2>
        <ul>
            
              <li>13 Jan 2021: <a href="/2021/01/13/decentralised-content-moderation.html">Decentralised content moderation</a></li>
            
              <li>02 Dec 2020: <a href="/2020/12/02/bloom-filter-hash-graph-sync.html">Using Bloom filters to efficiently synchronise hash graphs</a></li>
            
              <li>18 Nov 2020: <a href="/2020/11/18/distributed-systems-and-elliptic-curves.html">New courses on distributed systems and elliptic curve cryptography</a></li>
            
              <li>29 Sep 2020: <a href="/2020/09/29/is-book-writing-worth-it.html">Writing a book: is it worth it?</a></li>
            
              <li>31 Jan 2020: <a href="/2020/01/31/brief-brexit-lament.html">A brief Brexit lament</a></li>
            
            <li><a href="/archive.html">Full archive</a></li>
        </ul>
    </div>

    <div class="widget">
        <h2 class="title">Conference talks</h2>
        <ul>
            
              <li><a href="/2020/07/06/crdt-hard-parts-hydra.html">06 Jul 2020 at Hydra distributed computing conference</a></li>
            
              <li><a href="/2020/04/27/papoc-list-move.html">27 Apr 2020 at 7th Workshop on Principles and Practice of Consistency for Distributed Data (PaPoC)</a></li>
            
              <li><a href="/2019/11/08/code-mesh-isabelle.html">08 Nov 2019 at Code Mesh</a></li>
            
              <li><a href="/2019/10/02/tonke-dragt-tagung.html">02 Oct 2019 at Tagung über Tonke Dragts Jugendromane</a></li>
            
              <li><a href="/2019/09/14/strange-loop-isabelle.html">14 Sep 2019 at Strange Loop</a></li>
            
            <li><a href="/talks.html">Full archive</a></li>
        </ul>
    </div>
</div>

            </div>
        </div>

        <hr class="divider" />

<div id="footer">
    <div class="wrapper">
        <p id="generator-link">
            <a rel="license" href="http://creativecommons.org/licenses/by/3.0/"
                style="float: left; padding: 0.3em 1em 0 0;"><img alt="Creative Commons License"
                src="/images/creative-commons.png" width="88" height="31" /></a>
            Unless otherwise specified, all content on this site is licensed under a
            <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
                Attribution 3.0 Unported License</a>.
            Theme borrowed from
            <span id="theme-link"><a href="http://carringtontheme.com" title="Carrington theme for WordPress">Carrington</a></span>,
            ported to <a href="https://github.com/mojombo/jekyll">Jekyll</a> by Martin Kleppmann.
        </p>
    </div>
</div>

    </div>

    <!-- Twitter -->
<script>
!function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0],
        p = /^http:/.test(d.location) ? 'http' : 'https';
    if (!d.getElementById(id)) {
        js = d.createElement(s);
        js.id = id;
        js.src = p + "://platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js,fjs);
    }
}(document,"script","twitter-wjs");
</script>

</body>
</html>
