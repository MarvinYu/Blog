<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://gmpg.org/xfn/11">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Find my nearest toilet, curry, whatever &mdash; Martin Kleppmann&rsquo;s blog</title>
    <link rel="stylesheet" type="text/css" media="screen, print, handheld" href="/css/typography.css" />
<link rel="stylesheet" type="text/css" media="screen" href="/css/style.css" />
<link rel="stylesheet" type="text/css" media="all" href="/css/pygments-default.css" />
<link rel="stylesheet" type="text/css" media="all" href="/css/ansi2html.css" />
<link rel="stylesheet" type="text/css" media="all" href="/css/customizations.css?4" />
<!--[if lt IE 8]>
    <link rel="stylesheet" href="/css/ie.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/martinkl?format=xml" title="Martin Kleppmann's blog" />

</head>

<body class="wordpress">
    <div id="page">
        <p id="top">
    <a id="to-content" href="#content" title="Skip to content">Skip to content</a>
</p>

<div id="header">
    <div class="wrapper">
        <strong id="blog-title">
            <a href="/" title="Home" rel="home">Martin Kleppmann</a>
        </strong>
    </div>
</div>

<div id="sub-header">
    <div class="wrapper">
        <div id="navigation">
            <ul>
                <li class="page_item"><a href="/contact.html" title="About/Contact">About/Contact</a></li>
            </ul>
        </div>
    </div>
</div>

<hr class="divider">


        <div class="wrapper">
            <div id="content">
                <a class="twitter-share-button" href="https://twitter.com/share" data-text="Find my nearest toilet, curry, whatever"
                    data-via="martinkl" data-related="martinkl" data-size="large" data-count="none">Tweet</a>

                <h1>Find my nearest toilet, curry, whatever</h1>

                <p>Some interesting developments in so-called
<a href="http://en.wikipedia.org/wiki/Location-based_service">location based services</a> have hit the news in
the last few
days:</p>

<ul>
  <li>The city of Westminster, London, is running a trial of a system which recommends your
nearest public toilet if you send a text message to a shortcode. The name: “SatLav”. (<a href="http://www.telegraph.co.uk/news/main.jhtml?xml=/news/2007/11/29/nsatlav129.xml">Telegraph
article</a>,
<a href="http://www.computing.co.uk/vnunet/news/2204758/satlav-scheme-finds-toilets">Computing
article</a>)</li>
  <li>The
<a href="http://www.google.com/gmm/">Google Maps application</a> on mobile phones can now
<a href="http://www.youtube.com/watch?v=mIG-Dx7kF3Q">show your current location</a> on the map at your request.
(<a href="http://www.vodafonebetavine.net/web/guest/projects/resources/location_enhanced_services">Analysis by Steve
Harrop</a>)</li>
</ul>

<p>Although it can undoubtedly be very useful in many circumstances (I can certainly see myself using both the
toilet service and the map service), these developments do raise questions: How do they know where I
am? Does Google now know my location as well as my web searches, emails, contacts, diaries, YouTube
video preferences and everything else? How easy is it for a somebody to track where I am, and can
they do it without me noticing?</p>

<p>In case you were wondering, this is not GPS. There are phones with
in-build GPS, but they are still pretty rare and expensive. The remarkable thing about these
location technologies is that they work pretty well with a far broader range of handsets (although
Google Maps is more accurate if you have GPS).</p>

<p>So how does it work? As far as I know, there are the
following ways of finding your location:</p>

<ul>
  <li>GPS (only on a few phones such as the Nokia N95)</li>
  <li>Operator-based location lookup (<a href="http://www.mxtelecom.com/uk/lbs">as offered by MX
Telecom</a>, for example) – this is what SatLav
uses.</li>
  <li>Cell ID and cell location – this is what Google uses.</li>
</ul>

<p>GPS I won’t discuss
any further: it can be accessed only by applications installed on the phone, which need to be given
permission to do so – the phone itself controls the information, so the chances of abuse are pretty
low. (But see the Google-related caveat below.)</p>

<p>Operator lookup is a bit more concerning. To find
out somebody’s location, you need to know their phone number. You send a location request for that
number to the operator whom you are registered with. The operator sends a text message to the person
you are trying to locate, to ask for their consent. If they agree to release the location, that
information (latitude, longitude and an accuracy value) is sent to you who requested it. (I think
that’s how it works anyway – I’ve not seen it in action yet, and I can’t try it out since I’m on
the only mobile network in the UK which has not yet implemented location requests). The consent is
valid for only one look-up, so you don’t need to be concerned about the toilet finder service being
able to track you for the rest of your life just because you needed a loo in Westminster once.</p>

<p>The advantage of operator-based lookup is that it works on any phone, provided that phone’s network
supports location lookups. (In the UK, Vodafone, T-Mobile, O2 and Orange all do.) No software needs
to be installed, and it appears to be reasonably secure too. On the downside, the operators charge
for the service – about £0.10 a go, plus a monthly fee. And if you want to use a location-based
service (for example, to find your nearest xyz shop) you need to give that shop your mobile number,
risking that you may receive unwanted text message advertising from them in future.</p>

<p>Cell location
is a very different beast, and more difficult to understand too. You may know that the mobile phone
network is split into cells, each cell being the area covered by one particular receiver/transmitter
(e.g. on the roof of a building). Cells can be pretty small (a few dozen meters radius) in urban
areas, and much larger (several kilometers radius) in the countryside. A mobile phone is usually
locked onto one particular cell, and each cell has a unique identifier. On many handsets it is
possible for an application running on the phone to find out the identifier of the cell to which it
is connected.</p>

<p>So what does that give us? Only the cell ID is not worth much. But if you have a big
database which contains approximate locations for every cell in the world, you can make a pretty
good guess at where you are (provided you’re in a small cell at least). The problem: there does not
seem to be such a database. At least it’s not possible for normal people to get hold of it. The
operators (who have built all those cells) know where they are of course, but they won’t simply give
away that valuable information.</p>

<p>A number of collaborative projects are attempting to gather
location information of cells by combining many volunteering users’ contributions. Among these are
<a href="http://www.cellspotting.com/">CellSpotting</a>,
<a href="http://gsmloc.org/">GSM Location</a> and
<a href="http://www.navizon.com/">Navizon</a>. The general idea here is: people who have GPS in their handsets
walk/drive around, and every time the phone comes across a new cell, it sends the identifier of that
cell together with the GPS coordinates to the database. Over time, the database gets a pretty good
idea of the range of locations in which you lock onto a particular cell. Then people who don’t have
GPS can send their cell ID to the database to get an averaged value of their probable location.</p>

<p>(A
note on the side: people talk a lot in theory about using triangulation – measuring signal
strengths, angles of directional antennas, signal timings from several adjacent cells and so on. In
principle, these techniques could be used to provide a location which is more accurate than simply
“you are in cell X, and cell X covers this and that area”. In practise, I don’t think triangulation
is feasible on phones for all sorts of reasons – software limitations, hardware support etc. The
operator-based location lookup, which uses the cells rather than the handsets to measure timings,
may well use it – I don’t know.)</p>

<p>Now how does Google Maps get its location information for non-GPS
handsets? I have not yet heard a definite answer, but the general suspicion is that they use
precisely one of these databases. They might have bought it off the operators, but that’s a bit
unlikely. Chances are they merged together several open source projects, and also drove around in a
car themselves, mapping cells to GPS locations. And now that Google have released the application to
the public, they do exactly the same as Google always does: collect the data from as many users as
possible. Most probably, those people with GPS handsets who use Google Maps are unknowingly helping
to expand Google’s cell ID database. When a GPS user encounters a new cell, Google learns both the
location and the cell ID. Over time, their cell coverage and location accuracy will increase for the
benefit of non-GPS users.</p>

<p>So, does Google know where you are? Yes. If you do a location lookup, at
least. They claim to anonymise that data, so you can only hope that they are telling the truth.</p>

<p>One
final note: the mobile web does not come into this at all. That means, if a phone accesses a
website, there is in general no way of telling where that user is located (unless they explicitly
give the site their phone number and the site performs an operator location lookup).</p>


                

                <div id="disqus_thread"></div>
            </div>

            <div id="sidebar">
                <div id="carrington-subscribe" class="widget">
    <h2 class="widget-title">Subscribe</h2>
    <a class="feed" title="RSS 2.0 feed for posts" rel="alternate" href="http://feeds.feedburner.com/martinkl">
        Site <acronym title="Really Simple Syndication">RSS</acronym> feed
    </a>

    <div id="mc_embed_signup">
        <p>
            To get notified when I write something new,
            <a href="https://twitter.com/martinkl">follow me</a> on Twitter,
            <a href="http://feeds.feedburner.com/martinkl">subscribe</a> to the RSS feed,
            or enter your email address:
        </p>

        <form action="//kleppmann.us2.list-manage.com/subscribe/post?u=9a1adaf549282981a96e171d1&amp;id=4543b695f6"
            method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank" novalidate>
            <fieldset>
                <div class="mc-field-group">
                    <label for="mce-EMAIL">Email address:</label>
                    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
                </div>
                <div style="position: absolute; left: -5000px;"><input type="text" name="b_9a1adaf549282981a96e171d1_4543b695f6" tabindex="-1" value=""></div>
            </fieldset>
        </form>

        <p class="disclaimer">
            I won't give your address to anyone else, won't send you any spam, and you can unsubscribe at any time.
        </p>
    </div>
</div>

<div id="primary-sidebar">
    <div id="book-promo" class="widget">
        <h2 class="title">My book</h2>
        <p><a href="http://www.anrdoezrs.net/click-7658334-11260198?url=http%3A%2F%2Fshop.oreilly.com%2Fproduct%2F0636920032175.do%3Fcmp%3Daf-strata-books-videos-product_cj_9781491903094_%2525zp&cjsku=0636920032175" target="_top"><img src="/images/book-cover-small.png" border="0" alt="Designing Data-Intensive Applications" width="180" height="236"/></a></p>
        <p>My book,
        <a href="http://dataintensive.net">Designing Data-Intensive Applications</a>,
        is available in early release from O’Reilly.</p>
    </div>

    <div class="widget">
        <p>I am a researcher at the
        <a href="http://www.cl.cam.ac.uk/">University of Cambridge Computer Laboratory</a>,
        working at the intersection of databases, distributed systems, and information security.</p>
    </div>

    <div id="tweets" class="widget">
        <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/martinkl" data-widget-id="557543934298423296">Tweets by @martinkl</a>
    </div>
</div>

                


<div id="secondary-sidebar">
    <div class="widget">
        <h2 class="title">Recent posts</h2>
        <ul>
            
              <li>28 Dec 2015: <a href="/2015/12/28/year-2015-review.html">My year 2015 in review</a></li>
            
              <li>10 Nov 2015: <a href="/2015/11/10/investigatory-powers-bill.html">The Investigatory Powers Bill would increase cybercrime</a></li>
            
              <li>11 Oct 2015: <a href="/2015/10/11/recurse-center-joy-of-learning.html">The Recurse Center and the joy of learning</a></li>
            
              <li>05 Aug 2015: <a href="/2015/08/05/kafka-samza-unix-philosophy-distributed-data.html">Kafka, Samza, and the Unix philosophy of distributed data</a></li>
            
              <li>27 May 2015: <a href="/2015/05/27/logs-for-data-infrastructure.html">Using logs to build a solid data infrastructure (or: why dual writes are a bad idea)</a></li>
            
            <li><a href="/archive.html">Full archive</a></li>
        </ul>
    </div>

    <div class="widget">
        <h2 class="title">Conference talks</h2>
        <ul>
            
              <li><a href="/2016/01/29/event-sourcing-stream-processing-at-ddd-europe.html">29 Jan 2016 at Domain Driven Design Europe</a></li>
            
              <li><a href="/2015/11/13/change-data-capture-at-all-your-base.html">13 Nov 2015 at All Your Base</a></li>
            
              <li><a href="/2015/11/06/streams-as-team-interface-at-oredev.html">06 Nov 2015 at Øredev</a></li>
            
              <li><a href="/2015/11/05/database-inside-out-at-oredev.html">05 Nov 2015 at Øredev</a></li>
            
              <li><a href="/2015/11/04/transactions-at-code-mesh.html">04 Nov 2015 at Code Mesh</a></li>
            
            <li><a href="/talks.html">Full archive</a></li>
        </ul>
    </div>
</div>

            </div>
        </div>

        <hr class="divider" />

<div id="footer">
    <div class="wrapper">
        <p id="generator-link">
            <a rel="license" href="http://creativecommons.org/licenses/by/3.0/"
                style="float: left; padding: 0.3em 1em 0 0;"><img alt="Creative Commons License"
                src="/images/creative-commons.png" width="88" height="31" /></a>
            Unless otherwise specified, all content on this site is licensed under a
            <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
                Attribution 3.0 Unported License</a>.
            Theme borrowed from
            <span id="theme-link"><a href="http://carringtontheme.com" title="Carrington theme for WordPress">Carrington</a></span>,
            ported to <a href="https://github.com/mojombo/jekyll">Jekyll</a> by Martin Kleppmann.
        </p>
    </div>
</div>

<img src="https://www.lduhtrp.net/image-7658334-11260198" width="1" height="1" border="0"/>

    </div>

    <script type="text/javascript">
    var disqus_shortname = 'martinkl';
    var disqus_url = 'http://martin.kleppmann.com/2007/11/30/find-my-nearest-toilet-curry-whatever.html';
    var disqus_identifier = disqus_url;

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

    <!-- Google Analytics -->
<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-7958895-1");
        pageTracker._trackPageview();
    } catch (err) {}
</script>

<!-- Twitter -->
<script>
!function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0],
        p = /^http:/.test(d.location) ? 'http' : 'https';
    if (!d.getElementById(id)) {
        js = d.createElement(s);
        js.id = id;
        js.src = p + "://platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js,fjs);
    }
}(document,"script","twitter-wjs");
</script>

</body>
</html>
